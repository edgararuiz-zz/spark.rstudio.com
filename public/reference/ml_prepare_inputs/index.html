<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
   <link rel="stylesheet" href="../../stylesheets/bootstrap.min.css">
    <title> - sparklyr: R interface for Apache Spark</title>
    <meta name="generator" content="Hugo 0.20" />

    
    <meta name="description" content="A website built through Hugo and blogdown (and gitdown).">
    
    <link rel="canonical" href="../../reference/ml_prepare_inputs/">
    

    <meta property="og:url" content="/reference/ml_prepare_inputs/">
    <meta property="og:title" content="sparklyr: R interface for Apache Spark">
    <meta property="og:image" content="">
    <meta name="apple-mobile-web-app-title" content="sparklyr: R interface for Apache Spark">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="../../images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="../../images/favicon.ico">

    <link rel="stylesheet" href="../../stylesheets/fonts.css">
    <link rel="stylesheet" href="../../stylesheets/application.css">
    <link rel="stylesheet" href="../../stylesheets/temporary.css">
    <link rel="stylesheet" href="../../stylesheets/palettes.css">
    <link rel="stylesheet" href="../../stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,700|Roboto&#43;Mono">
    <style>
      body, input {
        font-family: 'Roboto', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="../../javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-rstudio-dark palette-accent-orange">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>

    <div>
      <h1><a href="../../">sparklyr: R interface for Apache Spark</a></h1>
    </div>


    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/rstudio" title="@rstudio on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/rstudio/sparklyr" title="@rstudio/sparklyr on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
   </div>

</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          





<li>
  
    



<a  title="Reference" href="../../reference/">
	
	Reference
</a>


  
</li>



<li>
  
    



<a  title="Documents" href="../../documents/">
	
	Documents
</a>


  
</li>



<li>
  
    



<a  title="News" href="../../news/">
	
	News
</a>


  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
		  <h1> </h1>
			

<h1 id="ml-prepare-response-features-intercept-pre-process-the-inputs-to-a-spark-ml-routine"><code>ml_prepare_response_features_intercept</code>: Pre-process the Inputs to a Spark ML Routine</h1>

<h2 id="description">Description</h2>

<p>Pre-process / normalize the inputs typically passed to a
 Spark ML routine.</p>

<h2 id="usage">Usage</h2>

<pre><code class="language-r">ml_prepare_response_features_intercept(x = NULL, response, features,
  intercept, envir = parent.frame(),
  categorical.transformations = new.env(parent = emptyenv()),
  ml.options = ml_options())
ml_prepare_features(x, features, envir = parent.frame(),
  ml.options = ml_options())
</code></pre>

<h2 id="arguments">Arguments</h2>

<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>x</code></td>
<td>An object coercable to a Spark DataFrame (typically, a <code>tbl_spark</code> ).</td>
</tr>

<tr>
<td><code>response</code></td>
<td>The name of the response vector (as a length-one character vector), or a formula, giving a symbolic description of the model to be fitted. When <code>response</code> is a formula, it is used in preference to other parameters to set the <code>response</code> , <code>features</code> , and <code>intercept</code>  parameters (if available). Currently, only simple linear combinations of existing parameters is supposed; e.g. <code>response ~ feature1 + feature2 + ...</code> . The intercept term can be omitted by using <code>- 1</code> in the model fit.</td>
</tr>

<tr>
<td><code>features</code></td>
<td>The name of features (terms) to use for the model fit.</td>
</tr>

<tr>
<td><code>intercept</code></td>
<td>Boolean; should the model be fit with an intercept term?</td>
</tr>

<tr>
<td><code>envir</code></td>
<td>The list() environment in which the <code>response</code> , <code>features</code>  and <code>intercept</code> bindings should be mutated. (Typically, the parent frame).</td>
</tr>

<tr>
<td><code>categorical.transformations</code></td>
<td>An list() environment used to record what categorical variables were binarized in this procedure. Categorical variables that included in the model formula will be transformed into binary variables, and the generated mappings will be stored in this environment.</td>
</tr>

<tr>
<td><code>ml.options</code></td>
<td>Optional arguments, used to affect the model generated. See <a href="ml_options.html"><code>ml_options</code></a> for more details.</td>
</tr>
</tbody>
</table>

<h2 id="details">Details</h2>

<p>Pre-processing of these inputs typically involves:</p>

<ul>
<li><p>Handling the case where <code>response</code> is itself a formula describing the model to be fit, thereby extracting the names of the <code>response</code> and <code>features</code> to be used,</p></li>

<li><p>Splitting categorical features into dummy variables (so they can easily be accommodated + specified in the underlying Spark ML model fit),</p></li>

<li><p>Mutating the associated variables in the specified environment .</p></li>
</ul>

<p>Please take heed of the last point, as while this is useful in practice,
 the behavior will be very surprising if you are not expecting it.</p>

<h2 id="examples">Examples</h2>

<pre><code class="language-r"> list(&quot;\n&quot;, &quot;# note that ml_prepare_features, by default, mutates the 'features'\n&quot;, &quot;# binding in the same environment in which the function was called\n&quot;, &quot;local({\n&quot;, &quot;   ml_prepare_features(features = ~ x1 + x2 + x3)\n&quot;, &quot;   print(features) # c(\&quot;x1\&quot;, \&quot;x2\&quot;, \&quot;x3\&quot;)\n&quot;, &quot;})\n&quot;) 
</code></pre>

		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="../../javascripts/application.js"></script>
    

    <script>
      
      var headers   = document.querySelectorAll('div.level2');
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            if(headers[i].id.length > 0){
              var li = document.createElement("li");
              li.setAttribute("class", "anchor");
              var a  = document.createElement("a");
              a.setAttribute("href", "#" + headers[i].id);
              a.setAttribute("title", headers[i].getElementsByTagName("h2")[0].innerHTM);
              a.innerHTML = headers[i].getElementsByTagName("h2")[0].innerHTML;
              li.appendChild(a)
              scrollspy.appendChild(li);
            }            
            
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }}
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

